#
#  For use when VMs have already been provisioned in order to capture IP addresses of
#  VMs that need to be connected with each other.
#
---
  - set_fact:
      database_ip_address: "127.0.0.1"
      gogs_ip_address:    "{{ ci_b_int_dns_name }}"
      jenkins_ip_address: "{{ ci_a_int_dns_name }}"
      jenkins_location:   "{{ ci_a_ext_dns_name }}"
      jenkins_url:        "{{ ci_a_ext_dns_name }}"
      nexus_ip_address:   "{{ ci_a_int_dns_name }}"
      sonar_ip_address:   "{{ ci_b_int_dns_name }}"
      remote_ip_address:  "{{ ci_dit_int_dns_name }}"

  # Add hosts and set variables
  - name: Add managed nodes
    add_host:
      groups: ci
      hostname: "{{ item.name }}"
      ansible_host: "{{ item.host }}"
      ansible_user: "root"
      ansible_port: 22
      become: "yes"
      connection: "ssh"
    with_items:
      - { name: "ci-a",   host: "{{ ci_a_ip }}" }
      - { name: "ci-b",   host: "{{ ci_b_ip }}" }
      - { name: "ci-dit", host: "{{ ci_dit_ip }}" }
